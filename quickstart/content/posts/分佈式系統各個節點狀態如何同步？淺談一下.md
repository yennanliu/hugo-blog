
+++
title = '分佈式系統各個節點狀態如何同步？淺談一下'
date = 2024-02-12T15:50:58
draft = false
+++
<!--more-->寫在前面：2020年面試必備的Java後端進階面試題總結了一份複習指南在Github上，內容詳細，圖文並茂，有需要學習的朋友可以Star一下！
GitHub地址：https://github.com/abel-max/Java-Study-Note/tree/master
分佈式系統（distributed system）正變得越來越重要，大型網站幾乎都是分佈式的。 分佈式系統的最大難點，就是各個節點的狀態如何同步。CAP 定理是這方面的基本定理，也是理解分佈式系統的起點。
一般來講,在高併發情況下,cap三者選其二,但實際上只有兩種選擇,一種爲cp,一種爲ap。
先看 Partition tolerance，中文叫做"分區容錯"。
系統如果不能在時限內達成數據一致性,意味着發生了分區的情況,需要在C和A作選擇.
大多數分佈式系統都分佈在多個子網絡。每個子網絡就叫做一個區（partition）。分區容錯的意思是，區間通信可能失敗。比如，一臺服務器放在中國，另一臺服務器放在美國，這就是兩個區，它們之間可能無法通信。

上圖中，G1 和 G2 是兩臺跨區的服務器。G1 向G2 發送一條消息，G2 可能無法收到。系統設計的時候，必須考慮到這種情況。
一般來說，分區容錯無法避免，因此可以認爲 CAP 的 P 總是成立。CAP 定理告訴我們，剩下的 C 和 A 無法同時做到。
Consistency中文叫做"一致性"。意思是，寫操作之後的讀操作，必須返回該值。舉例來說，某條記錄是 v0，用戶向 G1 發起一個寫操作，將其改爲 v1。
所有節點訪問同一份最新數據副本

接下來，用戶的讀操作就會得到 v1。這就叫一致性。

問題是，用戶有可能向 G2 發起讀操作，由於 G2 的值沒有發生變化，因此返回的是 v0。G1 和 G2 讀操作的結果不一致，這就不滿足一致性了。

爲了讓 G2 也能變爲 v1，就要在 G1 寫操作的時候，讓 G1 向 G2 發送一條消息，要求G2 也改成 v1。

這樣的話，用戶向 G2 發起讀操作，也能得到 v1。

Availability中文叫做"可用性"，意思是隻要收到用戶的請求，服務器就必須給出迴應。
對數據更新具備高可用性
用戶可以選擇向 G1 或G2 發起讀操作。不管是哪臺服務器，只要收到請求，就必須告訴用戶，到底是 v0 還是 v1，否則就不滿足可用性。
一致性和可用性，爲什麼不可能同時成立？答案很簡單，因爲可能通信失敗（即出現分區容錯）。
如果保證 G2 的一致性，那麼 G1 必須在寫操作時，鎖定 G2 的讀操作和寫操作。只有數據同步後，才能重新開放讀寫。鎖定期間，G2 不能讀寫，沒有可用性不。
如果保證 G2 的可用性，那麼勢必不能鎖定 G2，所以一致性不成立。
綜上所述，G2 無法同時做到一致性和可用性。系統設計時只能選擇一個目標。如果追求一致性，那麼無法保證所有節點的可用性；如果追求所有節點的可用性，那就沒法做到一致性。
舉例來說，發佈一張網頁到 CDN，多個服務器有這張網頁的副本。後來發現一個錯誤，需要更新網頁，這時只能每個服務器都更新一遍。
一般來說，網頁的更新不是特別強調一致性。短時期內，一些用戶拿到老版本，另一些用戶拿到新版本，問題不會特別大。但是每個用戶訪問以後,必須立刻有返回值,當然，所有人最終都會看到新版本。所以，這個場合就是可用性高於一致性。
目前看來,在分佈式系統中,p是基本會存在的,就是網絡間同步數據的延遲，而c也就是一致性保證的是特定時間內數據的一致性,就忽略了性能問題，而a也就是可用性,強調的是立刻返回結果,強調的是性能,那麼必定會出現數據不一致，根據不同的業務場景進行設計,要充分利用三者特性。


本文分享自華爲雲社區《應用安全防護ESAPI》，作者： Uncle_Tom。
1. ESAPI 簡介
OWASP Enterprise Security API (ESAPI）是一個免費、開源的web應用程序安全控制庫，使程序員更容易編寫




一.背景
性能優化是一場永無止境的旅程。
到家門店系統，作爲到家核心基礎服務之一，門店C端接口有着調用量高，性能要求高的特點。
C端服務經過演進，核心接口先查詢本地緩存，如果本地緩存沒有命中，再查詢Redis。本地緩存命中率99%，服務性




隨着 AI 智能浪潮到來，AI 智能編碼助手成爲越來越多開發者的必備工具，Github Copilot、Amazon CodeWhisperer 等 AI 編碼工具陸續登場，去年雲棲大會阿里雲發佈的 “通義靈碼” 同樣令人期待。
通義靈碼




前言
在上一篇文章《還在擔心報表不好做？不用怕，試試這個方法》中，小編分享瞭如何使用模板語言生成報表的過程。今天小編進一步介紹模板語言中一些基本的概念和用法，因此讀者可以配合上一篇文章一起看。
本文介紹的內容有：
模板文件
綁定數據源
單




LettuceConnectionFactory可以用於實現多模式的開發配置。下面是使用LettuceConnectionFactory實現單機模式、哨兵模式和集羣模式的示例：
單機模式配置：
import org.springfr




公司背景和業務
數禾科技以大數據和技術爲驅動，爲金融機構提供高效的智能零售金融解決方案，服務銀行、信託、消費金融公司、保險、小貸公司等持牌金融機構，業務涵蓋消費信貸、小微企業信貸、場景分期等多個領域，提供營銷獲客、風險防控、運營管




本文分享自華爲雲社區《服務運行時動態掛載JavaAgent和插件——Sermant熱插拔能力解析》，作者：華爲雲高級軟件工程師 欒文飛
一、概述
Sermant是基於Java字節碼增強技術的無代理服務網格，其利用Java字節碼增強技術，爲




如果你是企業經營者，在爲企業降本增效而發愁；
如果你是企業的開發、運維或架構同學，在日常工作中被開發效率、交付問題等困擾…… 歡迎來了解 Koupleless（原 SOFAServerless）！
現在，Koupleless 重磅發佈了




作者：饒子昊、楊龍
應用複雜度提升，根因定位困難重重
隨着軟件技術發展迭代，很多企業軟件系統也逐步從單體應用向雲原生微服務架構演進，一方面讓應用實現高併發、易擴展、開發敏捷度高等效果，但另外一方面也讓軟件應用鏈路變得越來越長，依賴的各種外部




背景介紹
應用安裝包的體積影響着用戶下載量、安裝時長、用戶磁盤佔用量等多個方面，據Google Play統計，應用體積每增加6MB，安裝的轉化率將下降1%。
安裝包的體積受諸多方面影響，針對dex、資源文件、so文件都有不同的優化策略，在




一、平臺介紹
財務自營計費主要承接京東自營數據在整個供應鏈中由C端轉B端的功能實現，在整個供應鏈中屬於靠後的階段了，系統主要功能是計費和向B端的彙總。
二、問題描述
近年來自營計費數據量大增，有百億+的數據量，一天中彙總佔據了一半的數據




版本依賴
1. spring-kafka: 2.2.2
2. kafka-clients: 2.0.0
使用示例
1. 構建監聽，acknowledgingMessageListener 爲接口org.springframework.k




近日，Apache Dubbo 發佈了 3.3 分支大版本 3.3.0-beta.1，相較於 3.2 系列版本，3.3.0-beta 引入了一些重量級的功能升級，按照社區規劃，3.3 也將是 Dubbo3 非常重要的一個里程碑大版本，在 3




 
Automotive Android OS多屏多窗口
DisplayAreaPolicy.Provider
    DisplayAreaPolicy用戶設置DisplayArea的層級結構。DisplayAreaPolicy.Pr




暢捷通介紹
暢捷通是中國領先的小微企業財稅及業務雲服務提供商，成立於2010年。暢捷通在2021年中國小微企業雲財稅市場份額排名第一，在產品前瞻性及行業全覆蓋方面領跑市場，位居中國小微企業雲財稅廠商矩陣領軍象限前列。作爲專注小微企業雲服務

